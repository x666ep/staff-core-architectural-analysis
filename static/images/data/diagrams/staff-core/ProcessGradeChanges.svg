<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="494px" preserveAspectRatio="none" style="width:446px;height:494px;background:#FFFFFF;" version="1.1" viewBox="0 0 446 494" width="446px" zoomAndPan="magnify"><defs/><g><ellipse cx="227.5" cy="20" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="#F1F1F1" height="48.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="356" x="49.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="336" x="59.5" y="71.6016">Выбираем из employee_grade_change_documents_actual</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="233" x="59.5" y="85.7344">актуальные на текущую дату приказы</text><rect fill="#F1F1F1" height="48.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="369" x="43" y="118.2656"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="284" x="53" y="139.8672">JOIN актуальных грейдов к таблице employees</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="349" x="53" y="154">с условием что отличается грейд или уровень должности</text><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="168.5" y="230.5313"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="98" x="178.5" y="252.1328">шифруем грейд</text><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="361" x="47" y="284.6641"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="341" x="57" y="306.2656">подготавливаем ивент/ивенты для внутреннего топика</text><rect fill="#F1F1F1" height="48.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="326" x="64.5" y="344.1641"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="306" x="74.5" y="365.7656">кладем наши события в табличку employee_events</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="208" x="74.5" y="379.8984">для дальнейшей отправки в kafka</text><rect fill="#F1F1F1" height="48.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="332" x="61.5" y="412.4297"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="312" x="71.5" y="434.0313">обновляем данные по грейду и уровню должности</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="131" x="71.5" y="448.1641">в табличке employees</text><polygon fill="#F1F1F1" points="90.5,186.5313,364.5,186.5313,376.5,198.5313,364.5,210.5313,90.5,210.5313,78.5,198.5313,90.5,186.5313" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="274" x="90.5" y="202.6885">Перебираем в цикле массив тех кто "сджойнился"</text><ellipse cx="24" cy="241.5313" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="24" cy="241.5313" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="227.5" y1="30" y2="50"/><polygon fill="#181818" points="223.5,40,227.5,50,231.5,40,227.5,44" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="227.5" y1="98.2656" y2="118.2656"/><polygon fill="#181818" points="223.5,108.2656,227.5,118.2656,231.5,108.2656,227.5,112.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="227.5" y1="264.6641" y2="284.6641"/><polygon fill="#181818" points="223.5,274.6641,227.5,284.6641,231.5,274.6641,227.5,278.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="227.5" y1="318.7969" y2="344.1641"/><polygon fill="#181818" points="223.5,334.1641,227.5,344.1641,231.5,334.1641,227.5,338.1641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="227.5" y1="392.4297" y2="412.4297"/><polygon fill="#181818" points="223.5,402.4297,227.5,412.4297,231.5,402.4297,227.5,406.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="227.5" y1="210.5313" y2="230.5313"/><polygon fill="#181818" points="223.5,220.5313,227.5,230.5313,231.5,220.5313,227.5,224.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="227.5" y1="460.6953" y2="470.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="420" y1="470.6953" y2="470.6953"/><polygon fill="#181818" points="416,338.7969,420,328.7969,424,338.7969,420,334.7969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="420" x2="420" y1="198.5313" y2="470.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="420" x2="376.5" y1="198.5313" y2="198.5313"/><polygon fill="#181818" points="386.5,194.5313,376.5,198.5313,386.5,202.5313,382.5,198.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78.5" x2="24" y1="198.5313" y2="198.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="24" x2="24" y1="198.5313" y2="230.5313"/><polygon fill="#181818" points="20,220.5313,24,230.5313,28,220.5313,24,224.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="227.5" y1="166.5313" y2="186.5313"/><polygon fill="#181818" points="223.5,176.5313,227.5,186.5313,231.5,176.5313,227.5,180.5313" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[e6ddeb53a59a315b0e6c234e2227ed01]
@startuml ProcessGradeChanges
skinparam ConditionEndStyle hline 
scale max 500 height
    start
        :Выбираем из employee_grade_change_documents_actual
        актуальные на текущую дату приказы;
        :JOIN актуальных грейдов к таблице employees
        с условием что отличается грейд или уровень должности;
        while (Перебираем в цикле массив тех кто "сджойнился")
            :шифруем грейд;
            :подготавливаем ивент/ивенты для внутреннего топика;
            :кладем наши события в табличку employee_events
            для дальнейшей отправки в kafka;
            :обновляем данные по грейду и уровню должности
            в табличке employees;
        endwhile
    stop
@enduml

PlantUML version 1.2022.7(Mon Aug 22 20:01:30 MSK 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: RU
--></g></svg>